"use strict";var Store={feedURL:"api/api.php",state:{instagramFeed:[],instagramQuery:"alterebro",instagramQueryType:null,instagramQueryTypes:[{type:"Username",symbol:"@"},{type:"Hashtag",symbol:"#"}],cubeSides:[{side:"left",label:"&#x31;",x:0,y:90},{side:"back",label:"&#x36;",x:0,y:-180},{side:"top",label:"&#x33;",x:-90,y:0},{side:"bottom",label:"&#x34;",x:90,y:0},{side:"front",label:"&#x35;",x:0,y:0},{side:"right",label:"&#x32;",x:0,y:-90}],cubeSideCurrent:null,cubeRotate:!0,cubeRotateId:null,cubeRotateMs:1500,cubeRotationSwing:25,cubeSize:300,modalWindowOpen:!1,cubeRotation:{transform:"translateZ(-3600px) rotateX(0deg) rotateY(0deg) translateY(500px)"},cubeShadow:{height:"0px",transform:"translateY(0px) scale(1)"},cubeContainer:{marginTop:"0px"}},changeSide:function(t,e){e||(this.state.cubeRotate=!1,this.state.cubeRotateId=null);var a=t.x+Math.floor(Math.random()*(2*this.state.cubeRotationSwing)-this.state.cubeRotationSwing),e=t.y+Math.floor(Math.random()*(2*this.state.cubeRotationSwing)-this.state.cubeRotationSwing);this.state.cubeRotation.transform="translateZ(-".concat(this.state.cubeSize/2,"px) rotateX(").concat(a,"deg) rotateY(").concat(e,"deg)"),this.state.cubeSideCurrent=t;a=Math.floor(4*Math.random())/10+1,e=Math.floor(this.state.cubeSize/5),t=Math.floor(Math.random()*(1.5*e));this.state.cubeShadow.transform="translateY(".concat(2*t,"px) scale(").concat(a,") rotateX(45deg)"),this.state.cubeShadow.height="".concat(e,"px"),this.state.cubeContainer.marginTop="-".concat(2*t,"px")},autoRotate:function(){var t,e=this;this.state.cubeRotate&&(t=Math.floor(Math.random()*this.state.cubeSides.length),this.changeSide(this.state.cubeSides[t],!0),this.state.cubeRotateId=window.setTimeout(function(){e.autoRotate()},this.state.cubeRotateMs))},setCubeSize:function(){var t=Math.min(window.innerWidth,window.innerHeight),t=3*Math.floor(t/4);Store.state.cubeSize=Store.state.cubeSize>t?t:Store.state.cubeSize,Store.state.cubeSize=Store.state.cubeSize<120?120:Store.state.cubeSize,document.documentElement.style.setProperty("--cube-size","".concat(Store.state.cubeSize,"px"))},getInstagramFeed:function(e,t){var a=this,o=!(1<arguments.length&&void 0!==t)||t,n=new XMLHttpRequest;n.overrideMimeType("application/json"),n.open("GET","".concat(Store.feedURL,"?q=").concat(e),!0),n.onreadystatechange=function(){if(4===n.readyState&&"200"==n.status&&""!=n.responseText){if(a.setUrlParams(e),a.state.instagramFeed=JSON.parse(n.responseText).slice(0,6),a.state.instagramFeed.length<6)for(var t=a.state.instagramFeed.length;t<6;t++)a.state.instagramFeed[t]={};o&&a.autoRotate()}else a.state.instagramFeed=[]},n.onload=function(t){},n.onerror=function(t){},n.send(null)},toggleModalWindow:function(t){this.state.modalWindowOpen=t},getUrlParams:function(){var t=this.state.instagramQueryTypes,e=new URLSearchParams(window.location.hash.split("#")[1]),a="alterebro",o=t[0];return e.has("username")?a=e.get("username"):e.has("hashtag")&&(a=e.get("hashtag"),o=t[1]),Store.state.instagramQuery=a,("@"==(Store.state.instagramQueryType=o).symbol?"@":"")+a},setUrlParams:function(){var t="".concat(Store.state.instagramQueryType.type.toLowerCase(),"=").concat(Store.state.instagramQuery);window.location.hash=t},refreshPage:function(){window.location=window.location.pathname}},CubeHead={data:function(){return Store.state},name:"CubeHead",methods:{requestFeed:function(){var t=this.instagramQuery.replace(/[^a-z0-9\._-]/gim,"").trim().substring(0,30),t="@"==this.instagramQueryType.symbol?"@".concat(t):t;Store.getInstagramFeed(t,!1)},focusize:function(t){t.target.select()},showModalWindow:function(){Store.toggleModalWindow(!0)},refreshPage:function(){Store.refreshPage()}},created:function(){}},CubeInfo={data:function(){return Store.state},name:"CubeInfo",methods:{hideModalWindow:function(){Store.toggleModalWindow(!1)}},created:function(){}},Cube={data:function(){return Store.state},name:"Cube"},CubeFoot={data:function(){return Store.state},name:"CubeFoot",filters:{capitalizeFirstLetter:function(t){return t.charAt(0).toUpperCase()+t.slice(1)}},methods:{changeSide:function(t){Store.changeSide(t,!1)},stopRotation:function(){Store.state.cubeRotate=!1},resumeRotation:function(){Store.state.cubeRotate=!0,Store.autoRotate()},zoomIn:function(){Store.state.cubeSize+=30,Store.setCubeSize()},zoomOut:function(){Store.state.cubeSize-=30,Store.setCubeSize()},lockCubeRotation:function(){Store.state.cubeRotationSwing=0,Store.changeSide(Store.state.cubeSideCurrent,!0)},unlockCubeRotation:function(){Store.state.cubeRotationSwing=25,Store.changeSide(Store.state.cubeSideCurrent,!0)}}},App=new Vue({el:"#app",components:{CubeHead:CubeHead,CubeInfo:CubeInfo,Cube:Cube,CubeFoot:CubeFoot},created:function(){var t=Math.max(document.documentElement.clientWidth,window.innerWidth||0),e=Math.max(document.documentElement.clientHeight,window.innerHeight||0);Store.state.cubeSize=Math.floor(Math.min(t,e)/2.5),Store.state.cubeSideCurrent=Store.state.cubeSides[0],Store.setCubeSize();e=Store.getUrlParams();Store.getInstagramFeed(e),window.addEventListener("resize",Store.setCubeSize)}});